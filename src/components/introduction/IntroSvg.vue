<template>
  <svg id="svg" 
    :width="width" 
    :height="height" 
    viewBox="0 0 495.081 283.141" 
    preserveAspectRatio="xMinYMin meet"
  >
    <defs>
      <linearGradient id="gradient" gradientTransform="rotate(90)">
        <stop id="gradientStop1" offset="0%" stop-color="var(--startColor)" />
        <stop id="gradientStop2 " offset="100%" stop-color="var(--stopColor)" />
      </linearGradient>
    </defs>
    <g>
      <path id="circle" fill="url('#gradient')"></path>
      <path d="M81.5 29.726 61.746 9.973 41.993 29.726 22.244 9.973 4.985 27.232 0 22.244 22.244 0l19.75 19.75L61.746 0 81.5 19.75 101.245 0l22.246 22.244-4.991 4.988-17.255-17.259z" transform="rotate(-30 480.31 128.698)" style="fill:#a8b1ce"/>
      <path d="M19.612 58.086A42.154 42.154 0 0 1 6.5 0l7.662 4.839a33.087 33.087 0 0 0 10.289 45.589z" transform="rotate(60 115.479 490.881)" style="fill:#cddeff"/>
      <g transform="translate(-37.922 -53.624)">
        <path id="cloak" transform="translate(-427.856 -286.523)" style="fill:#5a81fa"/>
        <path d="m536.695 597.626-6.051-1.818 4.133-24.2 8.93 2.683z" transform="translate(-277.09 -277.031)" style="fill:#fdc8ba"/>
        <path d="m659.349 755.715-19.51-5.862.074-.247a7.929 7.929 0 0 1 9.875-5.313l11.916 3.58z" transform="translate(-399.963 -428.791)" style="fill:#253138"/>
        <path d="M644.414 599.577H638.1l-3.006-24.37h9.325z" transform="translate(-327.71 -278.778)" style="fill:#fdc8ba"/>
        <path d="M772.886 759.074h-20.372v-.258a7.929 7.929 0 0 1 7.929-7.929h12.443z" transform="translate(-454.572 -432.15)" style="fill:#253138"/>
        <path d="M722.374 622.41a2.319 2.319 0 0 1-2.289-1.952l-9.385-58.519a1.8 1.8 0 0 0-3.447-.407l-24.3 58.51a2.328 2.328 0 0 1-2.875 1.311l-8.779-2.927a2.311 2.311 0 0 1-1.529-2.711l19.918-88.135a2.332 2.332 0 0 1 1.738-1.748l26.711-6.2a2.351 2.351 0 0 1 1.911.4c17.589 12.78 16.1 54.534 12.825 99.873a2.32 2.32 0 0 1-2.213 2.151l-8.185.356z" transform="translate(-414.441 -320.043)" style="fill:#91adfd"/>
        <path d="M710.065 495.645a20.562 20.562 0 0 1-8.773-2.028l-.094-.044-.037-.1-11.353-29.414-.216-5.111a12.251 12.251 0 0 1 12.93-12.75l12.053.679a12.258 12.258 0 0 1 11.563 12.167 8.275 8.275 0 0 1-1.821 9.722c-.163 1.006-1.687 11.465 4.064 17.216l.162.161-.141.18c-.093.121-7.479 9.32-18.337 9.322z" transform="translate(-424.07 -284.473)" style="fill:#c6d7fe"/>
        <path d="M755.57 525.177a5.182 5.182 0 0 0 2.719-7.466l12.038-13.937-9.49-1.235-9.977 13.424a5.21 5.21 0 0 0 4.709 9.214z" transform="translate(-452.651 -311.787)" style="fill:#fdc8ba"/>
        <path d="M756.268 489.064a2.314 2.314 0 0 1-1.272-.381l-5.954-3.905a2.315 2.315 0 0 1-.721-3.125l4.31-7.242a3.232 3.232 0 0 0-1.455-4.6l-12.383-5.552a7.382 7.382 0 0 1-4.181-8.2 7.339 7.339 0 0 1 10.53-5.027l18.785 9.626a9.883 9.883 0 0 1 3.507 14.579l-9.286 12.863a2.314 2.314 0 0 1-1.88.964z" transform="translate(-445.823 -286.43)" style="fill:#c6d7fe"/>
        <path id="hand" d="M638.748 342.736a5.182 5.182 0 0 1 1.6 7.784l9.873 15.545-9.568-.164-7.909-14.737a5.21 5.21 0 0 1 6-8.428z" style="fill:#fdc8ba"/>
        <path id="arm" d="m649.419 363.485 12.715 30.045 13.331 22.605a7.312 7.312 0 0 1-4.185 10.714 7.352 7.352 0 0 1-8.735-3.9l-25.694-54.9a2.319 2.319 0 0 1 1.391-3.191l8.331-2.676a2.372 2.372 0 0 1 .486-.1 2.306 2.306 0 0 1 2.36 1.403z" style="fill:#c6d7fe"/>
        <path d="M702.484 372.55c-3.657-1.7-8.148-2.259-11.869-.678s-6.259 5.633-5.055 9.22c.546 1.626 1.788 3.225 1.3 4.867-.373 1.264-1.673 2.1-2.949 2.692a10.988 10.988 0 0 0-3.6 2.093c-.923 1-1.116 2.724.037 3.5.38.256.855.377 1.223.646a1.944 1.944 0 0 1 .6 2.176A4.583 4.583 0 0 1 680.71 399c-1.309 1.129-3.04 2.421-2.633 4.024a2.823 2.823 0 0 0 1.905 1.782 9.465 9.465 0 0 0 2.8.369l38.633 1.217a14.644 14.644 0 0 0 3.814-.213 4.515 4.515 0 0 0 3-2.012 4.2 4.2 0 0 0-.66-4.335 41.109 41.109 0 0 0-3.275-3.462 5.494 5.494 0 0 1-1.754-4.157 10.626 10.626 0 0 1 1.527-3.369c.575-1.1.909-2.483.164-3.5-1.05-1.431-3.57-1.3-4.763-2.635-.9-1.006-.727-2.455-.816-3.752a9.1 9.1 0 0 0-5.453-7.438 10.735 10.735 0 0 0-9.768.665z" transform="translate(-418.466 -242.866)" style="fill:#253138"/>
        <circle cx="12.657" cy="12.657" r="12.657" transform="translate(272.791 137.912)" style="fill:#fdc8ba"/>
        <path d="M700.173 396.457a7.847 7.847 0 0 0 6.9-8.3 6.7 6.7 0 0 0 5.742 6.826c1.833.2 3.844-.353 5.439.572 1.768 1.025 2.333 3.513 4.175 4.4 1.779.855 4.039-.311 4.918-2.079a7.879 7.879 0 0 0 .081-5.777 16.312 16.312 0 0 0-27.153-6.687 10.444 10.444 0 0 0-3.232 6.219 6.125 6.125 0 0 0 3.017 6.017z" transform="translate(-427.674 -247.686)" style="fill:#253138"/>
      </g>
      <path d="M54.9 20.026 41.6 6.72 28.292 20.026 14.986 6.72 3.36 18.346 0 14.986 14.986 0l13.306 13.306L41.6 0l13.3 13.306L68.21 0 83.2 14.986l-3.36 3.36L68.21 6.72z" transform="rotate(49 198.985 436.633)" style="fill:#6a6e83"/>
      <path d="M1853.628 1711.2c-.243 0-.482 0-.725-.007a34.651 34.651 0 0 1-33.936-35.346l9.061.185a25.587 25.587 0 0 0 51.164 1.044l9.058.185a34.645 34.645 0 0 1-34.621 33.94z" transform="rotate(117.97 1459.748 365.74)" style="fill:#ffa8a9"/>
    </g>
  </svg>
</template>

<script>
  import { spline } from '@georgedoescode/spline';
  import SimplexNoise from 'simplex-noise';

  export default {
    name: 'IntroSvg',
    data() {
      return {
        width: null,
        height: null,
      }
    },
    mounted() {
      const path = document.querySelector('#circle');
      const root = document.querySelector('#svg');

      let hueNoiseOffset = 0;
      let noiseStep = 0.005;

      const simplex = new SimplexNoise();

      const points = createPoints();

      (function animate() {
        path.setAttribute("d", spline(points, 1, true));

        // for every point...
        for (let i = 0; i < points.length; i++) {
          const point = points[i];

          // return a pseudo random value between -1 / 1 based on this point's current x, y positions in "time"
          const nX = noise(point.noiseOffsetX, point.noiseOffsetX);
          const nY = noise(point.noiseOffsetY, point.noiseOffsetY);
          // map this noise value to a new value, somewhere between it's original location -20 and it's original location + 20
          const x = map(nX, -1, 1, point.originX - 20, point.originX + 20);
          const y = map(nY, -1, 1, point.originY - 20, point.originY + 20);

          // update the point's current coordinates
          point.x = x;
          point.y = y;

          // progress the point's x, y values through "time"
          point.noiseOffsetX += noiseStep;
          point.noiseOffsetY += noiseStep;
        }

        const hueNoise = noise(hueNoiseOffset, hueNoiseOffset);
        const hue = map(hueNoise, -1, 1, 0, 360);

        root.style.setProperty("--startColor", `hsl(${hue}, 82%, 96%)`);
        root.style.setProperty("--stopColor", `hsl(${hue + 60}, 82%, 96%)`);

        hueNoiseOffset += noiseStep / 6;

        requestAnimationFrame(animate);
      })();

      function map(n, start1, end1, start2, end2) {
        return ((n - start1) / (end1 - start1)) * (end2 - start2) + start2;
      }

      function noise(x, y) {
        return simplex.noise2D(x, y);
      }

      function createPoints() {
        const points = [];
        const numPoints = 6;
        const angleStep = (Math.PI * 2) / numPoints;
        const rad = 140;

        for (let i = 1; i <= numPoints; i++) {
          const theta = i * angleStep;

          const x = 250 + Math.cos(theta) * rad;
          const y = 50 + Math.sin(theta) * rad;

          points.push({
            x: x,
            y: y,

            originX: x,
            originY: y,

            noiseOffsetX: Math.random() * 1000,
            noiseOffsetY: Math.random() * 1000
          });
        }

        return points;
      }

      path.addEventListener("mouseover", () => {
        noiseStep = 0.01;
      });

      path.addEventListener("mouseleave", () => {
        noiseStep = 0.005;
      });
    }, 
    created() {
      this.resize();
      window.addEventListener("resize", this.resize);
    },
    unmounted() {
      window.removeEventListener("resize", this.resize);
    },
    methods: {
      setSize(ww){
        const size = ww * 0.28946;
        this.width = size;
        this.height = size * 0.57879;
      },
      resize(){
        const ww = document.body.clientWidth;
        this.setSize(ww);
      }
    },
  }
</script>

<style lang="scss" scoped>
  :root {
    --startColor: hsl(207, 82%, 96%);
    --stopColor: hsl(207, 82%, 96%);
  }
  path {
    cursor: pointer;
  }

  p {
    position: absolute;
    font-size: 1.125rem;
    font-weight: 500;
    bottom: 1rem;
    right: 1rem;
    color: #fff;
    font-family: system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  #cloak{
    animation: move 8s linear infinite alternate;
  }
  #hand, #arm{
    -webkit-transform-origin: 100% 100%;
    transform-origin: 100% 100%;
  }
  #hand{
    animation: shacking1 2s linear infinite alternate;
  }
  #arm{
    animation: shacking2 2s linear infinite alternate;
  }
  @keyframes move {
    0%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 73.461 12.159 104.866 -6.105 c 0.881279 -0.881279 -0.216 4.811 -3.716 11.467 s -7.489 13.87 -6.048 21.251 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 28.767 16.258 28.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    10%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 73.461 12.159 104.866 -6.105 c 0 0 -0.216 -0.189 -3.716 6.467 s -7.489 13.87 -6.048 21.251 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 33.767 16.258 33.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    20%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 65.632 14.8185 97.037 -3.44551 c 0 0 0 0 0 0 s -3.376 7.67751 -1.935 15.0585 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 43.767 16.258 43.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    30%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 25.211 8.503 59.7994 9.738 94.037 -3.44551 c 0 0 0 0 0 0 s 1.21531 8.09899 4.065 15.0585 c 3.69505 9.02406 8.746 9.108 12.759 17.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 19.375 -6.218 28.5 s 7.124 45.767 16.258 45.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -11.082 -7.956 -16.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    40%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 25.211 8.503 59.7994 9.738 94.037 -3.44551 c 0 0 0 0 0 0 s 1.21531 6.09899 4.065 13.0585 c 3.69505 9.02406 5.746 9.108 9.759 17.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -3.714 21.375 -3.218 30.5 s 7.124 37.767 16.258 37.774 c -13.538 2.1 -27.342 7.208 -40.871 5.053 s -27.5135 -9.732 -33.27 -16.486 c -4.4417 -5.21134 -6.35 -9.082 -9.956 -14.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -21.024 -8.9 -28.854 -17.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    50%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 7.329 32.3 12.073 c 25.211 8.503 54.7994 12.738 89.037 -0.445509 c 0 0 0 0 0 0 s 2.88026 6.81002 7.065 13.0585 c 7.383 11.024 7.746 9.108 11.759 17.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -3.714 21.375 -3.218 30.5 s 7.124 34.767 16.258 34.774 c -13.538 2.1 -27.342 7.208 -40.871 5.053 s -24.0334 -6.732 -31.27 -13.486 c -5.00589 -4.67203 -8.35 -9.082 -11.956 -14.9 c -10.435 -10.6206 -17.929 -14.578 -29.051 -18.093 s -21.024 -8.9 -28.854 -17.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    60%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 25.211 8.503 59.7994 9.738 94.037 -3.44551 c 0 0 0 0 0 0 s 1.21531 6.09899 4.065 13.0585 c 3.69505 9.02406 5.746 9.108 9.759 17.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -3.714 21.375 -3.218 30.5 s 7.124 37.767 16.258 37.774 c -13.538 2.1 -27.342 7.208 -40.871 5.053 s -27.5135 -9.732 -33.27 -16.486 c -4.4417 -5.21134 -6.35 -9.082 -9.956 -14.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -21.024 -8.9 -28.854 -17.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    70%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 25.211 8.503 59.7994 9.738 94.037 -3.44551 c 0 0 0 0 0 0 s 1.21531 8.09899 4.065 15.0585 c 3.69505 9.02406 8.746 9.108 12.759 17.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 19.375 -6.218 28.5 s 7.124 45.767 16.258 45.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -11.082 -7.956 -16.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    80%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 65.632 14.8185 97.037 -3.44551 c 0 0 0 0 0 0 s -3.376 7.67751 -1.935 15.0585 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 43.767 16.258 43.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    90%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 73.461 12.159 104.866 -6.105 c 0 0 -0.216 -0.189 -3.716 6.467 s -7.489 13.87 -6.048 21.251 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 33.767 16.258 33.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
    100%{
      d: path("M 699.8 454.361 c 10.419 -5.726 23.386 -4.577 34.611 -0.662 s 21.4 10.329 32.3 15.073 c 33.312 14.5 73.461 12.159 104.866 -6.105 c 0.881279 -0.881279 -0.216 4.811 -3.716 11.467 s -7.489 13.87 -6.048 21.251 c 1.844 9.445 11.746 15.108 15.759 23.854 c 3.809 8.3 1.764 18.054 -1.158 26.709 s -6.714 17.375 -6.218 26.5 s 7.124 28.767 16.258 28.774 c -13.538 2.1 -27.342 4.208 -40.871 2.053 s -26.988 -9.311 -33.27 -21.486 c -3.14 -6.085 -4.35 -13.082 -7.956 -18.9 c -6.142 -9.916 -17.929 -14.578 -29.051 -18.093 s -23.024 -6.9 -30.854 -15.544 c -7.461 -8.237 -9.824 -19.71 -13.777 -30.1 c -6.65754 -17.3869 -18.2207 -32.4665 -33.285 -43.407");
    }
  }
  @keyframes shacking1 {
    0%{
      transform: translate(-395.696px, -234.027px) rotate(0deg);
    }
    100%{
      transform: translate(-395.696px, -244.027px) rotate(-0.5deg);
    }
  }
  @keyframes shacking2 {
    0%{
      transform: translate(-398.409px, -243.706px) rotate(0deg);
    }
    100%{
      transform: translate(-398.409px, -253.706px) rotate(-0.5deg);
    }
  }
</style>